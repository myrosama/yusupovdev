<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Music - Boboxon Yusupov">
    <title>Music — Boboxon Yusupov</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="page scrollable">
        <main class="content">
            <div class="page-header">
                <a href="index.html" class="back-link">← back</a>
                <h1 class="page-title">Music</h1>
                <p class="page-subtitle">What I've been listening to lately.</p>
            </div>

            <section class="music-section">
                <h2 class="music-heading">Top Artists</h2>
                <ol class="music-list" id="artists-list">
                    <li class="music-item">
                        <span class="music-rank">...</span>
                        <div class="music-img-placeholder"></div>
                        <div class="music-info">
                            <span class="music-name">Loading...</span>
                        </div>
                    </li>
                </ol>
            </section>

            <section class="music-section">
                <h2 class="music-heading">Top Tracks</h2>
                <ol class="music-list" id="tracks-list">
                    <li class="music-item">
                        <span class="music-rank">...</span>
                        <div class="music-img-placeholder"></div>
                        <div class="music-info">
                            <span class="music-name">Loading...</span>
                            <span class="music-artist">...</span>
                        </div>
                    </li>
                </ol>
            </section>

            <nav class="nav horizontal" style="margin-top: 32px;">
                <a href="index.html">home</a>
                <a href="projects.html">projects</a>
                <a href="about.html">about</a>
            </nav>
        </main>
    </div>

    <script>
        const WORKER_URL = 'https://spotify-api.sadrikov49.workers.dev';

        async function loadMusic() {
            try {
                const response = await fetch(WORKER_URL);
                const data = await response.json();

                if (data.error) throw new Error(data.error);

                renderArtists(data.artists);
                renderTracks(data.tracks);
            } catch (error) {
                console.error('Failed to load music:', error);
                document.getElementById('artists-list').innerHTML =
                    '<li class="music-item"><span class="music-name" style="color: var(--text-muted);">Could not load data</span></li>';
                document.getElementById('tracks-list').innerHTML =
                    '<li class="music-item"><span class="music-name" style="color: var(--text-muted);">Could not load data</span></li>';
            }
        }

        function renderArtists(artists) {
            const list = document.getElementById('artists-list');
            list.innerHTML = artists.map(artist => `
                <li class="music-item">
                    <span class="music-rank">${artist.rank}</span>
                    ${artist.image ? `<img class="music-img" src="${artist.image}" alt="${artist.name}">` : '<div class="music-img-placeholder"></div>'}
                    <div class="music-info">
                        <a href="${artist.url}" target="_blank" class="music-name">${artist.name}</a>
                    </div>
                </li>
            `).join('');
        }

        function renderTracks(tracks) {
            const list = document.getElementById('tracks-list');
            list.innerHTML = tracks.map(track => `
                <li class="music-item">
                    <span class="music-rank">${track.rank}</span>
                    ${track.image ? `<img class="music-img" src="${track.image}" alt="${track.name}">` : '<div class="music-img-placeholder"></div>'}
                    <div class="music-info">
                        <a href="${track.url}" target="_blank" class="music-name">${track.name}</a>
                        <span class="music-artist">${track.artist}</span>
                    </div>
                </li>
            `).join('');
        }

        loadMusic();
    </script>
</body>

</html>